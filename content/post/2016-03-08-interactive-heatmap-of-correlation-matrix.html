---
title: Interactive Heatmap of Correlation Matrix
author: JVA
date: '2016-03-08'
slug: interactive-heatmap-of-correlation-matrix
categories:
  - R
tags:
  - heatmap
  - interactive
  - correlation
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/d3/d3.min.js"></script>
<script src="/rmarkdown-libs/d3-tip/index-min.js"></script>
<link href="/rmarkdown-libs/d3panels/d3panels.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/d3panels/d3panels.min.js"></script>
<script src="/rmarkdown-libs/qtlcharts_iplotCorr/iplotCorr.js"></script>
<script src="/rmarkdown-libs/qtlcharts_iplotCorr/iplotCorr_noscat.js"></script>
<script src="/rmarkdown-libs/iplotCorr-binding/iplotCorr.js"></script>


<p>I saw this tweet yesterday afternoon.</p>
{{< tweet 707272069071945728 >}}
<p>Earlier that same morning I had been perusing a presentation that <a href="http://kbroman.org/">Karl Broman</a> gave at <a href="https://www.amstat.org/meetings/jsm/2015/">JSM2015</a>, <a href="https://www.biostat.wisc.edu/~kbroman/presentations/JSM2015/">Interactive graphics for high-dimensional genetic data</a>. The talk included an interactive heatmap of a correlation matrix (slide 7) that seemed like it would be useful to many folks, not just those working with genetics data.</p>
<p>It was time to give it a try.</p>
<p>It couldn’t have been much simpler. I had to install the R package <strong>qtlcharts</strong>, then use the function <code>iplotCorr()</code>.</p>
<pre class="r"><code>library(qtlcharts)
iplotCorr(mat=mtcars, group=mtcars$cyl, reorder=TRUE)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="iplotCorr html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":{"indID":["Mazda RX4","Mazda RX4 Wag","Datsun 710","Hornet 4 Drive","Hornet Sportabout","Valiant","Duster 360","Merc 240D","Merc 230","Merc 280","Merc 280C","Merc 450SE","Merc 450SL","Merc 450SLC","Cadillac Fleetwood","Lincoln Continental","Chrysler Imperial","Fiat 128","Honda Civic","Toyota Corolla","Toyota Corona","Dodge Challenger","AMC Javelin","Camaro Z28","Pontiac Firebird","Fiat X1-9","Porsche 914-2","Lotus Europa","Ford Pantera L","Ferrari Dino","Maserati Bora","Volvo 142E"],"var":["carb","hp","wt","cyl","disp","drat","am","gear","qsec","mpg","vs"],"corr":[[1,0.74981,0.42761,0.52699,0.39498,-0.09079,0.057534,0.27407,-0.65625,-0.55093,-0.56961],[0.74981,1,0.65875,0.83245,0.79095,-0.44876,-0.2432,-0.1257,-0.70822,-0.77617,-0.7231],[0.42761,0.65875,1,0.7825,0.88798,-0.71244,-0.6925,-0.58329,-0.17472,-0.86766,-0.55492],[0.52699,0.83245,0.7825,1,0.90203,-0.69994,-0.52261,-0.49269,-0.59124,-0.85216,-0.81081],[0.39498,0.79095,0.88798,0.90203,1,-0.71021,-0.59123,-0.55557,-0.4337,-0.84755,-0.71042],[-0.09079,-0.44876,-0.71244,-0.69994,-0.71021,1,0.71271,0.69961,0.091205,0.68117,0.44028],[0.057534,-0.2432,-0.6925,-0.52261,-0.59123,0.71271,1,0.79406,-0.22986,0.59983,0.16835],[0.27407,-0.1257,-0.58329,-0.49269,-0.55557,0.69961,0.79406,1,-0.21268,0.48028,0.20602],[-0.65625,-0.70822,-0.17472,-0.59124,-0.4337,0.091205,-0.22986,-0.21268,1,0.41868,0.74454],[-0.55093,-0.77617,-0.86766,-0.85216,-0.84755,0.68117,0.59983,0.48028,0.41868,1,0.66404],[-0.56961,-0.7231,-0.55492,-0.81081,-0.71042,0.44028,0.16835,0.20602,0.74454,0.66404,1]],"rows":[0,1,2,3,4,5,6,7,8,9,10],"cols":[0,1,2,3,4,5,6,7,8,9,10],"dat":[[4,4,1,1,2,1,4,2,2,4,4,3,3,3,4,4,4,1,2,1,1,2,2,4,2,1,2,2,4,6,8,2],[110,110,93,110,175,105,245,62,95,123,123,180,180,180,205,215,230,66,52,65,97,150,150,245,175,66,91,113,264,175,335,109],[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],[6,6,4,6,8,6,8,4,4,6,6,8,8,8,8,8,8,4,4,4,4,8,8,8,8,4,4,4,8,6,8,4],[160,160,108,258,360,225,360,146.7,140.8,167.6,167.6,275.8,275.8,275.8,472,460,440,78.7,75.7,71.1,120.1,318,304,350,400,79,120.3,95.1,351,145,301,121],[3.9,3.9,3.85,3.08,3.15,2.76,3.21,3.69,3.92,3.92,3.92,3.07,3.07,3.07,2.93,3,3.23,4.08,4.93,4.22,3.7,2.76,3.15,3.73,3.08,4.08,4.43,3.77,4.22,3.62,3.54,4.11],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[4,4,4,3,3,3,3,4,4,4,4,3,3,3,3,3,3,4,4,4,3,3,3,3,3,4,5,5,5,5,5,4],[16.46,17.02,18.61,19.44,17.02,20.22,15.84,20,22.9,18.3,18.9,17.4,17.6,18,17.98,17.82,17.42,19.47,18.52,19.9,20.01,16.87,17.3,15.41,17.05,18.9,16.7,16.9,14.5,15.5,14.6,18.6],[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],[0,0,1,1,0,1,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,0,1,0,0,0,1]],"group":[6,6,4,6,8,6,8,4,4,6,6,8,8,8,8,8,8,4,4,4,4,8,8,8,8,4,4,4,8,6,8,4],"scatterplots":true},"chartOpts":null},"evals":[],"jsHooks":[]}</script>
<p>The first argument, <code>mat=</code>, is a data matrix where the rows represent observations and the columns represent variables. The second argument, <code>group=</code>, applies color coding to the scatterplot. The <code>reorder=</code> argument allows the variables to be arranged according to a built-in clustering algorithm. The output is an interactive heatmap of the correlation matrix. Hover over the heatmap to see the row, column, and cell values. Click on a cell to see a scatterplot with symbols colored by group.</p>
<p>I replied to the tweet with the full code.</p>
{{< tweet 707322651111337984 >}}
<p>One feature I would like to add to this graphic is a legend of some kind for the group colors in the scatterplot. Hovering over the points in the scatterplot gives the name of the row (the observation or individual), but it doesn’t specifically decode the color (in my example, the number of cylinders, 4 is red, 6 is green, and 8 is blue).</p>
